import{r as v,h as E,o as a,d as r,a as d,z,b as n,w as s,e as c,t,B as L,n as b,x as I,T as O,y as Q,i as R,c as w,g as f,u as C,F as U,f as D,Q as j,O as A}from"./app-4aad6063.js";import{_ as G}from"./ActionSection-aaf2a67c.js";import{_ as J}from"./DialogModal-aaf4c057.js";import{_ as M}from"./InputError-a644ff26.js";import{_ as V}from"./PrimaryButton-7e998bed.js";import{_ as S}from"./SecondaryButton-66f1fe03.js";import{_ as q}from"./TextInput-64b9543c.js";import{_ as W}from"./DangerButton-f09c0e22.js";import{_ as X}from"./InputLabel-06d31f6a.js";import"./SectionTitle-659f3eec.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./Modal-246df657.js";import"./XMarkIcon-c562f47a.js";const Y={class:"mt-4"},g={__name:"ConfirmsPassword",props:{title:{type:String,default:"Confirm Password"},content:{type:String,default:"For your security, please confirm your password to continue."},button:{type:String,default:"Confirm"}},emits:["confirmed"],setup(y,{emit:T}){const u=T,l=v(!1),o=E({password:"",error:"",processing:!1}),_=v(null),h=()=>{axios.get(route("password.confirmation")).then(i=>{i.data.confirmed?u("confirmed"):(l.value=!0,setTimeout(()=>_.value.focus(),250))})},p=()=>{o.processing=!0,axios.post(route("password.confirm"),{password:o.password}).then(()=>{o.processing=!1,m(),I().then(()=>u("confirmed"))}).catch(i=>{o.processing=!1,o.error=i.response.data.errors.password[0],_.value.focus()})},m=()=>{l.value=!1,o.password="",o.error=""};return(i,k)=>(a(),r("span",null,[d("span",{onClick:h},[z(i.$slots,"default")]),n(J,{show:l.value,onClose:m},{title:s(()=>[c(t(y.title),1)]),content:s(()=>[c(t(y.content)+" ",1),d("div",Y,[n(q,{ref_key:"passwordInput",ref:_,modelValue:o.password,"onUpdate:modelValue":k[0]||(k[0]=F=>o.password=F),type:"password",class:"mt-1 block w-full",placeholder:"Password",autocomplete:"current-password",onKeyup:L(p,["enter"]),error:o.error},null,8,["modelValue","error"]),n(M,{message:o.error,class:"mt-2"},null,8,["message"])])]),footer:s(()=>[n(S,{onClick:m},{default:s(()=>[c(" Cancel ")]),_:1}),n(V,{class:b(["ml-3",{"opacity-25":o.processing}]),disabled:o.processing,onClick:p},{default:s(()=>[c(t(y.button)+" "+t(o.processing?"...":""),1)]),_:1},8,["class","disabled"])]),_:1},8,["show"])]))}},Z={key:0,class:"text-lg font-medium text-slate-900 dark:text-slate-100"},ee={key:1,class:"text-lg font-medium text-slate-900 dark:text-slate-100"},te={key:2,class:"text-lg font-medium text-slate-900 dark:text-slate-100"},oe={class:"mt-3 max-w-xl text-sm text-slate-600 dark:text-slate-400"},ae={key:3},se={key:0},le={class:"mt-4 max-w-xl text-sm text-slate-600 dark:text-slate-400"},re={key:0,class:"font-semibold"},ne={key:1},ce=["innerHTML"],ue={key:0,class:"mt-4 max-w-xl text-sm text-slate-600 dark:text-slate-400"},ie={class:"font-semibold"},de=["innerHTML"],me={key:1,class:"mt-4"},fe={key:1},_e={class:"mt-4 max-w-xl text-sm text-slate-600 dark:text-slate-400"},pe={class:"font-semibold"},ve={class:"grid gap-1 max-w-xl mt-4 px-4 py-4 font-mono text-sm bg-slate-100 dark:bg-slate-900 rounded"},he={class:"mt-5"},we={key:0},ge={key:1},Ae={__name:"TwoFactorAuthenticationForm",props:{requiresConfirmation:Boolean},setup(y){const T=y,u=v(!1),l=v(!1),o=v(!1),_=v(null),h=v(null),p=v([]),m=O({code:""}),i=Q(()=>{var e;return!u.value&&((e=j().props.auth.user)==null?void 0:e.two_factor_enabled)});R(i,()=>{i.value||(m.reset(),m.clearErrors())});const k=()=>{u.value=!0,A.post(route("two-factor.enable"),{},{preserveScroll:!0,onSuccess:()=>Promise.all([F(),H(),$()]),onFinish:()=>{u.value=!1,l.value=T.requiresConfirmation}})},F=()=>axios.get(route("two-factor.qr-code")).then(e=>{_.value=e.data.svg}),H=()=>axios.get(route("two-factor.secret-key")).then(e=>{h.value=e.data.secretKey}),$=()=>axios.get(route("two-factor.recovery-codes")).then(e=>{p.value=e.data}),B=()=>{m.post(route("two-factor.confirm"),{errorBag:"confirmTwoFactorAuthentication",preserveScroll:!0,preserveState:!0,onSuccess:()=>{l.value=!1,_.value=null,h.value=null}})},N=()=>{axios.post(route("two-factor.recovery-codes")).then(()=>$())},K=()=>{o.value=!0,A.delete(route("two-factor.disable"),{preserveScroll:!0,onSuccess:()=>{o.value=!1,l.value=!1}})};return(e,P)=>(a(),w(G,null,{title:s(()=>[c(t(e.lang().label.two_factor_auth),1)]),description:s(()=>[c(t(e.lang().label.two_factor_auth_desctiption),1)]),content:s(()=>[i.value&&!l.value?(a(),r("h3",Z,t(e.lang().label.two_factor_auth_enabled),1)):i.value&&l.value?(a(),r("h3",ee,t(e.lang().label.two_factor_auth_enabling),1)):(a(),r("h3",te,t(e.lang().label.two_factor_auth_not_enabled),1)),d("div",oe,[d("p",null,t(e.lang().label.two_factor_auth_caption),1)]),i.value?(a(),r("div",ae,[_.value?(a(),r("div",se,[d("div",le,[l.value?(a(),r("p",re,t(e.lang().label.two_factor_auth_finish),1)):(a(),r("p",ne,t(e.lang().label.two_factor_auth_now_enabled),1))]),d("div",{class:"mt-4",innerHTML:_.value},null,8,ce),h.value?(a(),r("div",ue,[d("p",ie,[c(" Setup Key: "),d("span",{innerHTML:h.value},null,8,de)])])):f("",!0),l.value?(a(),r("div",me,[n(X,{for:"code",value:e.lang().label.code},null,8,["value"]),n(q,{id:"code",modelValue:C(m).code,"onUpdate:modelValue":P[0]||(P[0]=x=>C(m).code=x),type:"text",name:"code",class:"block mt-1 w-1/2",inputmode:"numeric",autofocus:"",autocomplete:"one-time-code",placeholder:"••••••",onKeyup:L(B,["enter"]),error:C(m).errors.code},null,8,["modelValue","error"]),n(M,{message:C(m).errors.code,class:"mt-2"},null,8,["message"])])):f("",!0)])):f("",!0),p.value.length>0&&!l.value?(a(),r("div",fe,[d("div",_e,[d("p",pe,t(e.lang().label.two_factor_auth_recovery_code),1)]),d("div",ve,[(a(!0),r(U,null,D(p.value,x=>(a(),r("div",{key:x},t(x),1))),128))])])):f("",!0)])):f("",!0),d("div",he,[i.value?(a(),r("div",ge,[n(g,{onConfirmed:B},{default:s(()=>[l.value?(a(),w(V,{key:0,type:"button",class:b(["mr-3",{"opacity-25":u.value}]),disabled:u.value},{default:s(()=>[c(t(e.lang().button.confirm)+" "+t(u.value?"...":""),1)]),_:1},8,["class","disabled"])):f("",!0)]),_:1}),n(g,{onConfirmed:N},{default:s(()=>[p.value.length>0&&!l.value?(a(),w(S,{key:0,class:"mr-3"},{default:s(()=>[c(t(e.lang().button.regenerate_recovery_codes),1)]),_:1})):f("",!0)]),_:1}),n(g,{onConfirmed:$},{default:s(()=>[p.value.length===0&&!l.value?(a(),w(S,{key:0,class:"mr-3"},{default:s(()=>[c(t(e.lang().button.show_recovery_codes),1)]),_:1})):f("",!0)]),_:1}),n(g,{onConfirmed:K},{default:s(()=>[l.value?(a(),w(S,{key:0,class:b({"opacity-25":o.value}),disabled:o.value},{default:s(()=>[c(t(e.lang().button.cancel)+" "+t(o.value?"...":""),1)]),_:1},8,["class","disabled"])):f("",!0)]),_:1}),n(g,{onConfirmed:K},{default:s(()=>[l.value?f("",!0):(a(),w(W,{key:0,class:b({"opacity-25":o.value}),disabled:o.value},{default:s(()=>[c(t(e.lang().button.disable)+" "+t(o.value?"...":""),1)]),_:1},8,["class","disabled"]))]),_:1})])):(a(),r("div",we,[n(g,{onConfirmed:k},{default:s(()=>[n(V,{type:"button",class:b({"opacity-25":u.value}),disabled:u.value},{default:s(()=>[c(t(e.lang().button.enable)+" "+t(u.value?"...":""),1)]),_:1},8,["class","disabled"])]),_:1})]))])]),_:1}))}};export{Ae as default};
